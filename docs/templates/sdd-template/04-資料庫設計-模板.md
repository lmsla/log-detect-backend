# [專案名稱] - 資料庫設計文件

## 文件資訊

| 項目 | 內容 |
|------|------|
| 文件版本 | [版本號] |
| 最後更新 | [日期] |
| 文件類型 | 軟體設計文件 (SDD) - 資料庫設計 |

---

## 1. 資料庫架構概覽

### 1.1 資料庫清單

<!-- TODO: 列出專案使用的所有資料庫 -->

| 資料庫名稱 | 類型 | 用途 | 主要資料 |
|-----------|------|------|---------|
| [資料庫1] | [類型] | [用途] | [資料類型] |
| [資料庫2] | [類型] | [用途] | [資料類型] |

<!-- 範例：
| app_db | PostgreSQL | 業務資料 | 使用者、訂單、產品 |
| cache_db | Redis | 快取 | Session、臨時資料 |
-->

### 1.2 資料庫架構圖

<!-- TODO: 繪製資料庫架構圖 -->

```
┌─────────────────────────────────────────────────────────┐
│                  應用程式層                               │
└────────┬─────────────────┬──────────────────┬───────────┘
         │                 │                  │
    ┌────▼─────┐    ┌─────▼──────┐    ┌─────▼─────┐
    │[資料庫1] │    │ [資料庫2]   │    │ [資料庫3] │
    │          │    │             │    │           │
    │ [用途]   │    │  [用途]     │    │  [用途]   │
    └──────────┘    └─────────────┘    └───────────┘
```

---

## 2. [資料庫 1] 設計

<!-- TODO: 為每個資料庫建立一個章節 -->

### 2.1 資料庫資訊

- **資料庫名稱**: `[名稱]`
- **字元集**: `[字元集，如 utf8mb4]`
- **排序規則**: `[排序規則]`
- **引擎**: [引擎，如 InnoDB]
- **版本**: [版本號]

### 2.2 資料表列表

<!-- TODO: 列出所有資料表 -->

| 編號 | 資料表名稱 | 用途 | 估計筆數 |
|------|-----------|------|---------|
| 1 | [表名1] | [用途] | [數量] |
| 2 | [表名2] | [用途] | [數量] |
| 3 | [表名3] | [用途] | [數量] |

### 2.3 核心資料表設計

#### 2.3.1 [資料表 1 名稱]

<!-- TODO: 為重要資料表提供完整的 CREATE TABLE 語句 -->

**用途**：[資料表用途說明]

**SQL 定義**：
```sql
CREATE TABLE `[表名]` (
  `[欄位1]` [類型] [約束] COMMENT '[說明]',
  `[欄位2]` [類型] [約束] COMMENT '[說明]',
  `[欄位3]` [類型] [約束] COMMENT '[說明]',
  `created_at` TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  `updated_at` TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,

  PRIMARY KEY (`[主鍵]`),
  INDEX `[索引名]` (`[欄位]`),
  UNIQUE KEY `[唯一鍵名]` (`[欄位]`),
  FOREIGN KEY (`[外鍵]`) REFERENCES `[參考表]`(`[參考欄位]`)
) ENGINE=[引擎] DEFAULT CHARSET=[字元集] COMMENT='[表說明]';
```

**欄位說明**：

| 欄位名稱 | 類型 | 約束 | 說明 | 範例值 |
|---------|------|------|------|--------|
| [欄位1] | [類型] | [約束] | [說明] | [範例] |
| [欄位2] | [類型] | [約束] | [說明] | [範例] |

**索引說明**：

| 索引名稱 | 類型 | 欄位 | 用途 |
|---------|------|------|------|
| [索引名] | [類型] | [欄位] | [用途] |

<!-- 完整範例：

#### 2.3.1 users（使用者）

**用途**：儲存使用者帳號資訊

**SQL 定義**：
```sql
CREATE TABLE `users` (
  `id` INT UNSIGNED NOT NULL AUTO_INCREMENT PRIMARY KEY,
  `username` VARCHAR(50) NOT NULL UNIQUE COMMENT '使用者名稱',
  `email` VARCHAR(100) NOT NULL UNIQUE COMMENT '電子郵件',
  `password` VARCHAR(255) NOT NULL COMMENT 'bcrypt 雜湊密碼',
  `is_active` BOOLEAN DEFAULT TRUE COMMENT '是否啟用',
  `created_at` TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  `updated_at` TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,

  INDEX `idx_username` (`username`),
  INDEX `idx_email` (`email`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='使用者帳號表';
```

**欄位說明**：

| 欄位名稱 | 類型 | 約束 | 說明 | 範例值 |
|---------|------|------|------|--------|
| id | INT UNSIGNED | PK, AUTO_INCREMENT | 使用者 ID | 1 |
| username | VARCHAR(50) | NOT NULL, UNIQUE | 使用者名稱 | admin |
| email | VARCHAR(100) | NOT NULL, UNIQUE | 電子郵件 | admin@example.com |
| password | VARCHAR(255) | NOT NULL | bcrypt 雜湊密碼 | $2a$10$... |
| is_active | BOOLEAN | DEFAULT TRUE | 是否啟用 | true |

-->

#### 2.3.2 [資料表 2 名稱]

<!-- TODO: 複製上方格式，填寫其他重要資料表 -->

---

## 3. 資料關聯設計

### 3.1 ER 圖

<!-- TODO: 繪製 ER 圖，顯示資料表之間的關聯 -->

```
┌─────────────┐        ┌──────────────┐       ┌──────────────┐
│  [表1]      │────────│   [關聯表]    │───────│   [表2]      │
│             │ 1:N    │               │ N:M   │              │
│ - [欄位1]   │        │ - [欄位1]     │       │ - [欄位1]    │
│ - [欄位2]   │        │ - [欄位2]     │       │ - [欄位2]    │
└─────────────┘        └──────────────┘       └──────────────┘
```

<!-- 範例：

```
┌─────────────┐        ┌──────────────┐       ┌──────────────┐
│   users     │────────│  user_roles  │───────│    roles     │
│             │ 1:N    │              │ N:M   │              │
│ - id        │        │ - user_id    │       │ - id         │
│ - username  │        │ - role_id    │       │ - name       │
│ - email     │        └──────────────┘       └──────────────┘
└─────────────┘
```

-->

### 3.2 關聯說明

<!-- TODO: 說明重要的資料關聯 -->

| 關聯類型 | 主表 | 從表 | 關聯欄位 | 說明 |
|---------|------|------|---------|------|
| [類型] | [表名] | [表名] | [欄位] | [說明] |

<!-- 範例：
| 1:N | users | orders | user_id | 一個使用者可有多個訂單 |
| N:M | users | roles | user_roles 中介表 | 使用者與角色多對多關聯 |
-->

---

## 4. 索引策略

<!-- TODO: 說明索引設計原則 -->

### 4.1 索引原則

- ✅ **[原則 1]**：[說明]
- ✅ **[原則 2]**：[說明]
- ✅ **[原則 3]**：[說明]

<!-- 範例：
- ✅ **所有外鍵建立索引**：加速 JOIN 查詢
- ✅ **常用查詢欄位建立索引**：提升查詢效能
- ✅ **避免過多索引**：平衡查詢與寫入效能
-->

### 4.2 複合索引

<!-- TODO: 列出重要的複合索引 -->

| 資料表 | 索引名稱 | 欄位 | 用途 |
|-------|---------|------|------|
| [表名] | [索引名] | [欄位列表] | [用途] |

---

## 5. 資料保留與封存策略

<!-- TODO: 定義資料保留政策 -->

### 5.1 資料保留期限

| 資料表 | 保留期限 | 封存策略 |
|--------|---------|---------|
| [表名] | [期限] | [策略] |

<!-- 範例：
| logs | 30 天 | 移至 logs_archive 表 |
| sessions | 7 天 | 直接刪除 |
-->

### 5.2 封存腳本

<!-- 📝 選填：提供封存腳本範例 -->

```sql
-- 封存 [資料表] 資料
INSERT INTO [封存表]
SELECT * FROM [原表]
WHERE [條件];

-- 刪除原表舊資料
DELETE FROM [原表]
WHERE [條件];
```

---

## 6. 查詢最佳化

<!-- TODO: 提供常用查詢的最佳化建議 -->

### 6.1 常用查詢範例

#### 查詢 1：[查詢說明]

```sql
-- TODO: 填寫查詢 SQL
SELECT [欄位]
FROM [表名]
WHERE [條件]
```

**效能分析**：
- 使用索引：`[索引名]`
- 預估掃描行數：[數量]

### 6.2 查詢優化技巧

- ✅ **[技巧 1]**：[說明]
- ✅ **[技巧 2]**：[說明]

<!-- 範例：
- ✅ **使用 LIMIT**：限制結果集大小
- ✅ **避免 SELECT ***：只選擇需要的欄位
- ✅ **使用 EXPLAIN**：分析查詢計畫
-->

---

## 7. 備份策略

<!-- TODO: 定義備份策略 -->

### 7.1 備份計畫

| 備份類型 | 頻率 | 保留期限 | 儲存位置 |
|---------|------|---------|---------|
| [類型] | [頻率] | [期限] | [位置] |

<!-- 範例：
| 完整備份 | 每日 | 30 天 | /backup/full |
| 增量備份 | 每小時 | 7 天 | /backup/incremental |
-->

### 7.2 復原計畫

**RTO（復原時間目標）**：[時間]
**RPO（復原點目標）**：[時間]

**復原步驟**：
1. [步驟 1]
2. [步驟 2]
3. [步驟 3]

---

## 8. 資料庫監控

<!-- 📝 選填：但建議填寫 -->

### 8.1 監控指標

| 指標 | 警報閾值 | 說明 |
|------|---------|------|
| [指標] | [閾值] | [說明] |

<!-- 範例：
| 連線數 | > 80% | 連線池接近上限 |
| 慢查詢 | > 1 秒 | 查詢效能問題 |
| 磁碟使用率 | > 80% | 儲存空間不足 |
-->

### 8.2 效能基準

<!-- TODO: 記錄效能基準值 -->

| 操作 | 預期時間 | 實際測試 |
|------|---------|---------|
| [操作] | [時間] | [時間] |

---

## 9. 資料遷移

<!-- 📝 選填：如有版本升級或遷移計畫 -->

### 9.1 遷移腳本

```sql
-- TODO: 填寫遷移 SQL
-- Version [版本號]
-- Description: [描述]

-- 新增欄位
ALTER TABLE [表名] ADD COLUMN [欄位] [類型];

-- 建立索引
CREATE INDEX [索引名] ON [表名] ([欄位]);
```

### 9.2 遷移步驟

1. **備份資料**：[說明]
2. **執行遷移**：[說明]
3. **驗證資料**：[說明]
4. **回滾計畫**：[說明]

---

## 10. 資料字典

<!-- 📝 選填：但建議為重要欄位提供 -->

### 10.1 列舉值定義

<!-- TODO: 定義常用的列舉值 -->

#### [欄位名稱]

| 值 | 說明 |
|----|------|
| [值1] | [說明] |
| [值2] | [說明] |

<!-- 範例：

#### user_status

| 值 | 說明 |
|----|------|
| active | 啟用 |
| inactive | 停用 |
| pending | 待審核 |

-->

### 10.2 狀態流轉

<!-- TODO: 定義狀態欄位的流轉規則 -->

```
[狀態1] → [狀態2] → [狀態3]
  ↓          ↓          ↓
[說明]     [說明]     [說明]
```

---

**文件結束**

<!--
檢查清單：
□ 所有資料表都已定義
□ CREATE TABLE 語句都已驗證
□ ER 圖已繪製
□ 索引策略已說明
□ 備份策略已定義
□ 資料保留政策已制定
□ 常用查詢已最佳化
-->
