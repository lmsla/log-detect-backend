# Log Detect Backend - 軟體設計文件 (SDD)

## 📋 文件總覽

歡迎閱讀 **Log Detect Backend** 的完整軟體設計文件（Software Design Document, SDD）。本文件集依照 IEEE 軟體設計文件標準編寫，提供系統架構、API 規格、資料庫設計、安全策略等完整資訊。

**文件版本**: 2.0
**最後更新**: 2025-11-18
**文件語言**: 繁體中文

---

## 🗂️ 文件架構

本 SDD 包含以下主要章節：

### 核心規格文件

| 編號 | 文件名稱 | 檔案 | 用途 | 頁數 |
|------|---------|------|------|------|
| 1 | **系統概述** | [01-系統概述.md](./01-系統概述.md) | 專案簡介、系統特色、整體架構 | ~400 行 |
| 2 | **架構設計** | [02-架構設計.md](./02-架構設計.md) | 詳細架構圖、組件互動、資料流程 | ~700 行 |
| 3 | **API 規格** | [03-API規格.md](./03-API規格.md) | 完整 REST API 端點定義與範例 | ~600 行 |
| 4 | **資料庫設計** | [04-資料庫設計.md](./04-資料庫設計.md) | 資料表結構、ER 圖、最佳化策略 | ~550 行 |
| 5 | **安全與部署** | [05-安全與部署.md](./05-安全與部署.md) | 安全設計、部署指南、維運監控 | ~600 行 |

### 參考文件

| 文件名稱 | 檔案 | 說明 |
|---------|------|------|
| **程式碼分析** | [程式碼分析.md](./程式碼分析.md) | 完整程式碼庫分析（22 個服務、9 個控制器） |
| **架構圖表** | [架構圖表.md](./架構圖表.md) | 視覺化架構與流程圖（原始版本） |
| **快速參考** | [快速參考.md](./快速參考.md) | 開發者快速查詢手冊 |

---

## 🎯 針對不同角色的閱讀建議

### 🏗️ 系統架構師

**推薦閱讀順序**：
1. 📄 [系統概述](./01-系統概述.md) - 了解整體設計理念
2. 🏛️ [架構設計](./02-架構設計.md) - 深入研究技術架構
3. 🗄️ [資料庫設計](./04-資料庫設計.md) - 資料模型與儲存策略
4. 📚 [程式碼分析](./程式碼分析.md) - 程式碼層級實作細節

**關注重點**：
- 多資料庫架構設計
- 批次處理與時序資料最佳化
- 系統可擴展性與效能考量

### 💻 後端開發人員

**推薦閱讀順序**：
1. 📘 [快速參考](./快速參考.md) - 快速上手
2. 🔌 [API 規格](./03-API規格.md) - API 開發指南
3. 💾 [資料庫設計](./04-資料庫設計.md) - 資料操作規範
4. 🔍 [程式碼分析](./程式碼分析.md) - 深入理解現有程式碼

**關注重點**：
- 服務層架構與業務邏輯
- GORM 資料庫操作
- 中介軟體與錯誤處理

### 🚀 DevOps / 維運人員

**推薦閱讀順序**：
1. 🔐 [安全與部署](./05-安全與部署.md) - 部署與維運完整指南
2. 📊 [系統概述](./01-系統概述.md) - 了解系統運作原理
3. 🗄️ [資料庫設計](./04-資料庫設計.md) - 資料庫維護與備份
4. 📚 [快速參考](./快速參考.md) - 除錯技巧

**關注重點**：
- 部署架構與環境配置
- 監控指標與告警規則
- 備份與災難復原
- 日誌管理與疑難排解

### 🔌 API 整合者

**推薦閱讀順序**：
1. 🔗 [API 規格](./03-API規格.md) - 完整 API 參考
2. 🔑 [安全與部署](./05-安全與部署.md) - JWT 認證機制
3. 📊 [系統概述](./01-系統概述.md) - 系統能力與限制

**關注重點**：
- JWT 認證流程
- API 端點定義
- 請求/回應格式
- 錯誤碼處理

### 🧪 QA / 測試人員

**推薦閱讀順序**：
1. 📋 [系統概述](./01-系統概述.md) - 功能範圍與業務流程
2. 🔄 [架構設計](./02-架構設計.md) - 資料流程與狀態變化
3. 🔌 [API 規格](./03-API規格.md) - API 測試規格

**關注重點**：
- 業務流程與狀態轉換
- API 測試案例
- 邊界條件與錯誤處理

---

## 📚 快速導航

### 按主題查找

#### 🔐 認證與授權
- JWT 認證機制 → [安全與部署 § 2](./05-安全與部署.md#2-身份認證)
- RBAC 權限控制 → [安全與部署 § 3](./05-安全與部署.md#3-授權與權限控制)
- 使用者管理 API → [API 規格 § 2](./03-API規格.md#2-認證-api)

#### 📊 監控功能
- 裝置監控流程 → [系統概述 § 4.2](./01-系統概述.md#42-裝置監控流程)
- ES 健康監控 → [程式碼分析](./程式碼分析.md) (搜尋 "Elasticsearch 監控")
- 監控 API → [API 規格 § 6](./03-API規格.md#6-elasticsearch-監控-api)

#### 🗄️ 資料管理
- 資料庫架構 → [資料庫設計 § 1](./04-資料庫設計.md#1-資料庫架構概覽)
- 批次寫入機制 → [程式碼分析](./程式碼分析.md) (搜尋 "batch_writer")
- 資料保留策略 → [資料庫設計 § 6](./04-資料庫設計.md#6-資料保留與封存策略)

#### 🚀 部署維運
- 部署步驟 → [安全與部署 § 8](./05-安全與部署.md#8-部署步驟)
- 監控告警 → [安全與部署 § 9](./05-安全與部署.md#9-監控與維運)
- 疑難排解 → [安全與部署 § 12](./05-安全與部署.md#12-疑難排解)

---

## 🔍 關鍵統計

### 系統規模

| 指標 | 數值 |
|------|------|
| 總程式碼行數 | ~20,000 行 |
| 服務數量 | 22 個 |
| 控制器數量 | 9 個 |
| API 端點 | 60+ 個 |
| 資料模型 | 20+ 個 |
| MySQL 資料表 | 16 個 |
| TimescaleDB 超表 | 3 個 |

### 文件規模

| 指標 | 數值 |
|------|------|
| SDD 文件總行數 | ~3,000 行 |
| 文件總字數 | ~50,000 字 |
| 核心文件數量 | 5 份 |
| 參考文件數量 | 3 份 |
| 程式碼範例 | 100+ 個 |
| 圖表數量 | 30+ 個 |

---

## 🏛️ 系統簡介

### 核心功能

1. **裝置監控** 📡
   - 自動發現裝置
   - 即時狀態追蹤
   - 離線異常偵測

2. **Elasticsearch 監控** 🔍
   - 叢集健康監控
   - 效能指標追蹤
   - 智慧警報系統

3. **時序資料分析** 📈
   - TimescaleDB 儲存
   - 批次寫入最佳化
   - 歷史趨勢分析

4. **權限管理** 🔐
   - JWT 身份驗證
   - RBAC 授權模型
   - 細緻權限控制

### 技術堆疊

| 層級 | 技術 | 版本 |
|------|------|------|
| 程式語言 | Go | 1.24 |
| Web 框架 | Gin | 1.9.1 |
| 配置資料庫 | MySQL | 8.0 |
| 時序資料庫 | TimescaleDB | latest |
| 搜尋引擎 | Elasticsearch | v8 |
| 身份驗證 | JWT | - |

---

## 🛠️ 開發資源

### Swagger API 文件

互動式 API 文件：
```
http://your-server:8006/swagger/index.html
```

### 範例請求

**登入並取得令牌**：
```bash
curl -X POST http://localhost:8006/auth/login \
  -H "Content-Type: application/json" \
  -d '{"username":"admin","password":"admin123"}'
```

**查詢儀表板**：
```bash
curl -X GET http://localhost:8006/api/v1/dashboard/overview \
  -H "Authorization: Bearer {your-token}"
```

---

## 📝 文件維護

### 變更歷史

| 版本 | 日期 | 變更內容 | 作者 |
|------|------|---------|------|
| 2.0 | 2025-11-18 | SDD 重構，全面更新規格文件 | Claude |
| 1.0 | 2024-10-29 | 初始版本，基礎文件建立 | 原始團隊 |

### 文件更新流程

1. 程式碼變更時，同步更新相關文件
2. 每季進行文件全面審查
3. 重大功能更新時，更新架構圖
4. API 變更時，更新 API 規格與 Swagger

---

## 🔗 相關連結

- **專案 Repository**: [GitHub](https://github.com/lmsla/log-detect-backend)
- **問題回報**: [Issues](https://github.com/lmsla/log-detect-backend/issues)
- **Swagger 文件**: `/swagger/index.html`

---

## 📞 聯絡資訊

如有任何文件相關問題或建議，歡迎透過以下方式聯繫：

- 📧 Email: [專案負責人信箱]
- 💬 Slack: [團隊頻道]
- 📋 Issue Tracker: GitHub Issues

---

## ⚖️ 授權聲明

本文件與專案程式碼採用相同授權。

---

**感謝您閱讀本文件！**

🌟 如果這份文件對您有幫助，請給我們一個 Star！
